{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://raw.githubusercontent.com/FloWuenne/nf-proteindesign-2025/main/assets/schema_input_p2rank.json",
  "title": "FloWuenne/nf-proteindesign-2025 - P2Rank mode samplesheet schema",
  "description": "Schema for validating samplesheets in P2Rank mode where binding sites are predicted before design generation",
  "type": "array",
  "items": {
    "type": "object",
    "properties": {
      "sample_id": {
        "type": "string",
        "pattern": "^[a-zA-Z0-9_-]+$",
        "errorMessage": "Sample ID must be alphanumeric with underscores or hyphens only"
      },
      "target_structure": {
        "type": "string",
        "format": "file-path",
        "pattern": "^\\S+\\.(pdb|cif|PDB|CIF)$",
        "errorMessage": "Target structure must be a valid file path ending in .pdb or .cif",
        "exists": true
      },
      "use_p2rank": {
        "type": "boolean",
        "errorMessage": "use_p2rank must be true or false"
      },
      "top_n_pockets": {
        "type": "integer",
        "minimum": 1,
        "errorMessage": "Number of top pockets must be a positive integer"
      },
      "min_pocket_score": {
        "type": "number",
        "minimum": 0,
        "maximum": 1,
        "errorMessage": "Minimum pocket score must be a number between 0 and 1"
      },
      "binding_region_mode": {
        "type": "string",
        "enum": ["residues", "bounding_box"],
        "errorMessage": "Binding region mode must be either 'residues' or 'bounding_box'"
      },
      "expand_region": {
        "type": "integer",
        "minimum": 0,
        "errorMessage": "Expand region must be a non-negative integer"
      },
      "min_length": {
        "type": "integer",
        "minimum": 1,
        "errorMessage": "Minimum length must be a positive integer"
      },
      "max_length": {
        "type": "integer",
        "minimum": 1,
        "errorMessage": "Maximum length must be a positive integer"
      },
      "length_step": {
        "type": "integer",
        "minimum": 1,
        "errorMessage": "Length step must be a positive integer"
      },
      "n_variants_per_length": {
        "type": "integer",
        "minimum": 1,
        "errorMessage": "Number of variants per length must be a positive integer"
      },
      "design_type": {
        "type": "string",
        "enum": ["protein", "peptide", "nanobody"],
        "errorMessage": "Design type must be one of: protein, peptide, nanobody"
      },
      "protocol": {
        "type": "string",
        "enum": [
          "protein-anything",
          "peptide-anything",
          "protein-small_molecule",
          "nanobody-anything"
        ],
        "errorMessage": "Protocol must be one of: protein-anything, peptide-anything, protein-small_molecule, nanobody-anything"
      },
      "num_designs": {
        "type": "integer",
        "minimum": 1,
        "errorMessage": "Number of designs must be a positive integer"
      },
      "budget": {
        "type": "integer",
        "minimum": 1,
        "errorMessage": "Budget must be a positive integer"
      }
    },
    "required": ["sample_id", "target_structure"]
  }
}
